---
title: "IS investigation worksheet"
author: "by Team-Name: User1, User2, User3, User4 & User5."
date: "`r Sys.Date()`"
output: html_document
---

**Note:** You can use this file as you 'working document' where you can try out various investigation ideas and keep notes about your findings. How you use and structure this file is up to you. It is recommended that you keep notes about what you are investigating and what you find as this will make the process of creating your presentation and report easier. Please note that you _do not_ need to submit this file as part of your 
group project.

5 Steps 

- stating and refining question

  - Describe - 
  - Explore - analyse for relationships between variables, crime and community variables. 
  - Infer - Analyse data from a group, race, age, income, parents
  - Predict - Predictions on an individual or a population. Must involve the goal variable, Violent crimes per population. A look at the determining factors of Violent Crimes Per Pop
  - Casual - 
  - Mechanistic - how does one variable impact another
  
  - confounding variables?
  
- exploratory data analysis

  - graph against violent crimes per population 
  - frequency distribution
  
  checklist:
  
  - validate
  - top,  bottom, middle rows
  - plot
  - 

- model building

- interpreting results

- communicating results

Data Type, attributes, kinds of questions i can answer.

Objective Statement/ Problem Statement

cleaning 
- NA
- column name
- importing
- remove 0 and 1 from dataset and replace with... 

back up data source


Exploratory Data Analysis:

-What type of variation occurs within variables?

  - what is most common? why?
  - what values are rare? why? does this match expectations?
  - unusual patterns? Explain
  - How are obsrvations within subgroup similar
  - how are observations in different clusters diffeerent from each other
  - explain or descrie clusters
  
See a Pattern? Ask yourself:

- is it coincidence?
- how can you describe the relationship?
- how strong is the relationship
- what other variables may affect the relationship
- does the relationship change if you look at subgroups of the data

-What type of covariation occurs between my variables?




summary statistics
- Mean 
- Standard deviation

visualisations

map

select algorithm/method

evaluate model

The Question.

What is Crime?

- 

What is community?


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r load-lib, message = FALSE}
library(tidyverse)
# Add any other libraries here



```


```{r load-data, include = TRUE}
# load your data 

data <- read.csv("data/crime/communities.data", header = FALSE, na.string = "?")
  
names_lines <- read_lines("data/crime/communities.names")
  
  
attribute_lines <- grep("^@attribute", names_lines, value = TRUE)
attribute_lines <- gsub("@attribute ", "", attribute_lines)
attribute_lines <- gsub(" .*", "", attribute_lines)
  
colnames(data) <- c(attribute_lines)

frequency_state <- data %>%
  group_by(state) %>%
  summarise(count = n())

frequency_community <- data %>%
  group_by(communityname) %>%
  summarise(count = n())


# view column names

column_names <- colnames(data)

view(column_names)

# Sort column names



#Race

race <- data %>%
  select("state", "communityname",  "population","racepctblack","racePctWhite","racePctAsian","racePctHisp") 
view(race)


#Age


  
age <- data %>%
  select("state", "communityname", "population", "agePct12t21", "agePct12t29", "agePct16t24", "agePct65up")

view(age)

# Mutating state to names

state_names <- data.frame(
  state = c(1, 2, 4, 5, 6, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 44, 45, 46, 47, 48, 49, 50, 51, 53, 54, 55, 56),
  state_name = c("ALABAMA", "ALASKA", "ARIZONA", "ARKANSAS", "CALIFORNIA", "COLORADO", "CONNECTICUT", "DELAWARE", "DISTRICT OF COLUMBIA", "FLORIDA", "GEORGIA", "HAWAII", "IDAHO", "ILLINOIS", "INDIANA", "IOWA", "KANSAS", "KENTUCKY", "LOUISIANA", "MAINE", "MARYLAND", "MASSACHUSETTS", "MICHIGAN", "MINNESOTA", "MISSISSIPPI", "MISSOURI", "MONTANA", "NEBRASKA", "NEVADA", "NEW HAMPSHIRE", "NEW JERSEY", "NEW MEXICO", "NEW YORK", "NORTH CAROLINA", "NORTH DAKOTA", "OHIO", "OKLAHOMA", "OREGON", "PENNSYLVANIA", "RHODE ISLAND", "SOUTH CAROLINA", "SOUTH DAKOTA", "TENNESSEE", "TEXAS", "UTAH", "VERMONT", "VIRGINIA", "WASHINGTON", "WEST VIRGINIA", "WISCONSIN", "WYOMING")
)

data <- data %>%
  left_join(state_names, by = "state") %>%
  select(state_name,everything(),-state) %>%
  rename(state = state_name)

View(data)


# employment




#education
  
#per capita
  
#poverty
  
#divorce etc
```

```{r main-program} 
# Main Program

plot_y <- function (data, variable) {
  plot <- ggplot(data = data,
    mapping = aes(x=ViolentCrimesPerPop, y = variable)) +
  geom_point() + 
  xlim(0.0,1.0) + 
  ylim(0.0,1.0) +
  labs(title = "Population against ViolentCrimesPerPop", 
       x = "ViolentCrimesPerPop",
       y= variable)
  print(plot)

}


# Visualise population against violentcrimes per pop

plot <- ggplot(data = data,
    mapping = aes(x=ViolentCrimesPerPop, y = population)) +
  geom_point() + 
  xlim(0.0,1.0) + 
  ylim(0.0,1.0) +
  labs(title = "Population against ViolentCrimesPerPop", 
       x = "ViolentCrimesPerPop",
       y="Population")
print(plot)

# visualise perCapInc against violentcrimesperpop


plot <- ggplot(data = data,
    mapping = aes(x=ViolentCrimesPerPop, y = perCapInc)) +
  geom_point() + 
  xlim(0.0,1.0) + 
  ylim(0.0,1.0) +
  labs(title = "PerCapInc against ViolentCrimesPerPop", 
       x = "ViolentCrimesPerPop",
       y="PerCapInc")
print(plot)

# percentage unemployed

plot <- ggplot(data = data,
    mapping = aes(x=ViolentCrimesPerPop, y = PctUnemployed)) +
  geom_point() + 
  xlim(0.0,1.0) + 
  ylim(0.0,1.0) +
  labs(title = "PctUnemployed against ViolentCrimesPerPop", 
       x = "ViolentCrimesPerPop",
       y="PctUnemployed")
print(plot)

# percentage employed


plot <- ggplot(data = data,
    mapping = aes(x=ViolentCrimesPerPop, y = PctEmploy)) +
  geom_point() + 
  xlim(0.0,1.0) + 
  ylim(0.0,1.0) +
  labs(title = "Pctemploy against ViolentCrimesPerPop", 
       x = "ViolentCrimesPerPop",
       y="PctEmploy")
print(plot)


# policeperpop

plot <- ggplot(data = data,
    mapping = aes(x=ViolentCrimesPerPop, y = PolicPerPop)) +
  geom_point() + 
  xlim(0.0,1.0) + 
  ylim(0.0,1.0) +
  labs(title = "policeperpop against ViolentCrimesPerPop", 
       x = "ViolentCrimesPerPop",
       y="policeperpop")
print(plot)

# policoperbudget

plot <- ggplot(data = data,
    mapping = aes(x=ViolentCrimesPerPop, y = PolicOperBudg)) +
  geom_point() + 
  xlim(0.0,1.0) + 
  ylim(0.0,1.0) +
  labs(title = "policoperbudg against ViolentCrimesPerPop", 
       x = "ViolentCrimesPerPop",
       y="policoperbudg")
print(plot)

# police budget per pop

# pct born same state

# numstreet

# num in shelters

# (numstreet + num in shelters) /2 ( not very useful)


plot <- ggplot(data = data,
    mapping = aes(x=ViolentCrimesPerPop, y = (NumStreet + NumInShelters))) +
  geom_point() + 
  xlim(0.0,1.0) + 
  ylim(0.0,0.5) +
  labs(title = "PctUnemployed against ViolentCrimesPerPop", 
       x = "ViolentCrimesPerPop",
       y="PctUnemployed")
print(plot)

# plot distribution of each variable

```