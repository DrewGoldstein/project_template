---
title: "Building A Model to Determine the Relationship Between Socio-Economic Factors and Crime"
subtitle: ""
author: "Crime Crunchers <br> Drew Goldstein, Manuel Cabrera, Dimitris Bardanis, Dimitris Agouridis, Shane Chesen, Samuel Prior"
institute: "University of Edinburgh"
date: "`r Sys.Date()`"
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    lib_dir: libs
    nature:
      ratio: "16:9"
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      
---

```{r install-package, include = FALSE, eval = FALSE}
# Copy and paste the following code into your console to download and install
# the `xaringan` package that contains all of the code which allows you 
# to create presentation slides in Rmarkdown
install.packages('xaringan')
```


```{r load-packages, include = FALSE}
# Add any additional packages you need to this chunk
library(tidyverse)
library(tidymodels)
library(palmerpenguins)
library(knitr)
library(xaringanthemer)
```

```{r setup, include=FALSE}
# For better figure resolution
knitr::opts_chunk$set(fig.retina = 3, dpi = 300, fig.width = 6, fig.asp = 0.618, out.width = "80%")
```

```{r load-data, include=FALSE}
# Load your data here
data <- read.csv("data/crime/communitiesUnnormalized.txt", header = FALSE, na.string = "?")
  
names_lines <- read_lines("data/crime/names.names")
  
  
attribute_lines <- grep("^@attribute", names_lines, value = TRUE)
attribute_lines <- gsub("@attribute ", "", attribute_lines)
attribute_lines <- gsub(" .*", "", attribute_lines)

colnames(data) <- c(attribute_lines)

column_names <- colnames(data)

```

# What is The Data?

- The data was obtained from US government agencies who retrieved the data through internal surveys. The data contains information on location, socio-economic factors, crime data as well as police department data. 

- The data is designed around the goal variable, ViolentCrimesPerPopulation. This is the response variable which will be predicted. There are 122 predictive variables all of which are decimal numerical values between 0 and 1. As well as non predictive string and numerical variables describing location and county/community code. 

- The data was taken from a data set with numerical values and normalised between 0 and 1. The dataset was available online, the dataset was imported and a new dataframe was created.

---

# What kind of question can this answer?

Questions regarding crime in the community with regards to:
- Economic Factors 
- Education
- Social Factors
- Police 

---

class: center, middle

## The Goal Is to Determine a Relationship Between Socio-Economic Factors and Crime per Population

---



# What is the Question?

Which factors influence the crime level of a community in the United States?

Using these factors can a suitable model be defined?

--

How to answer this?
--

- Through EDA, identify suitable variables with a high correlation to the goal variable.
- Create a model with these variables 
- Evaluate the validity of the model

---

# Background Info

---

# Variables of Interest

.pull-left[
Economic:

- medIncome 
- IncomePerCap
- PctPopUnderPov 
- PctUnemployed 
- PctNotHSGrad
- pctPoverty
- medFamIncome
 
Police:

- LemasSwornFTPerPop
]
.pull-right[
Demographic:

- agePct12t21
- agePct12t29
- pctUrban
- pctworkmom
- pct2par
- 
- 

Goal Variable:

- violentperPop
]

--

The indicators in the categories are all similar so it would only be useful to investigate one of these as they are highly correlated with each other. We shall try and determine which has the greatest correlation by way of line of best fit

---

# Importing Data

The dataset was imported from as a .txt file however had a format of a .data file. The column names were stored in a seperate .names file which had information pertaining to the dataset and variables as well as sources and methods. The columns were read from the text file and stored in a df with the column names being read in and stored as the column names. At this point the state was stored as a numerical value and so we got the relevant state codes from .. and replaced the numbers with codes.
The unnormalized version of the data was found online and then joined to our dataset. 

Cleaning

- Remove NAs 
- Replacing normalised data
- Dropping unnecesary variables

---

# Pre Processing

- The perCapInc variable is split into four categories representing the level of wealth of each city.
- Family statistics were calculated and summarised. 
- State initials replaced state codes 
- Geospatial data added for states

---

# Variables used

- perCapInc
- pctPoverty
- pct2Par
- pctWorkMom-6
- violentPerPop
- medFamIncome

--- 

# Description of Techniques Used

Scatter plots were used to determine a relationship between variables and violent crimes per population, this was important as it allowed us to determine which variables were correlated and should be used in our model. 

histograms 

maps

box plots

residuals plots

roc curves

---

# Model

The model used was a linear model 

---

# Results

---

# Exploratory Data Analysis

violent crimes per wealth category

crimes vs percentages of people under poverty 

gradient coefficients

boxplot of violent crimes 

---

![My Plot](img/scatter.png)

residuals plot 

roc curve

maps

---

# Results in Context

---

# Discussion

---

# With More Time?

---

# Feeling adventurous?

- Want to find out more about `xaringan`? See https://slides.yihui.name/xaringan/#1.

- You are welcome to use the default styling of the slides. In fact, that's what I expect majority of you will do. You will differentiate yourself with the content of your presentation.

- But some of you might want to play around with slide styling. The 
`xaringanthemer` provides some solutions for this that: https://pkg.garrickadenbuie.com/xaringanthemer.

- And if you want more bells and whistles, there is also `xaringanExtra`: https://pkg.garrickadenbuie.com/xaringanExtra.
